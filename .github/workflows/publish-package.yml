---
    name: Publish Package
    
    on:
      workflow_call:
        secrets:
            NODE_AUTH_TOKEN:
              required: true
        inputs:
            workspace-name:
              description: "Name of the workspace to publish"
              required: true
              type: string
    
    jobs:
      build:
        runs-on: [self-hosted, dind]
        steps:
          - uses: actions/checkout@v4

          - uses: actions/setup-node@v4
            with:
              node-version: '20.x'
              registry-url: 'https://npm.pkg.github.com'

          - name: Enable Corepack and set Yarn version
            run: |
              corepack enable
              corepack prepare yarn@4.7.0 --activate
    
          - run: |
              yarn config set npmAlwaysAuth true
              yarn config set npmAuthToken ${{ secrets.NODE_AUTH_TOKEN }}
              yarn config set npmPublishRegistry https://npm.pkg.github.com
    
          - name: Publish to GitHub Packages
            run: yarn workspace ${{ inputs.workspace-name }} npm publish
              